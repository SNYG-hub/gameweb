import{r as H,w as ae,c as C,a as U,o as Y,b as c,d as e,u as R,e as x,f as A,g as P,h as G,F as L,i as $,v as S,j as X,t as h,k as u,l as b,m as ye,n as V,p as be,q as T,s as J,x as ke,y as E,z as W,A as re,B as le,C as we,D as $e,E as Ce}from"./vendor-CuQ5Z0Jx.js";import{c as Ae}from"./supabase-DC4Of1qZ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();const xe="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='128'%20height='128'%20viewBox='0%200%20128%20128'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3clinearGradient%20id='g-neon'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20stop-color='%2300e5ff'/%3e%3cstop%20offset='50%25'%20stop-color='%23ff00aa'/%3e%3cstop%20offset='100%25'%20stop-color='%238ef511'/%3e%3c/linearGradient%3e%3cfilter%20id='f-glow'%20x='-50%25'%20y='-50%25'%20width='200%25'%20height='200%25'%3e%3cfeGaussianBlur%20in='SourceGraphic'%20stdDeviation='3'%20result='blur1'/%3e%3cfeGaussianBlur%20in='SourceGraphic'%20stdDeviation='8'%20result='blur2'/%3e%3cfeMerge%3e%3cfeMergeNode%20in='blur2'/%3e%3cfeMergeNode%20in='blur1'/%3e%3cfeMergeNode%20in='SourceGraphic'/%3e%3c/feMerge%3e%3c/filter%3e%3cclipPath%20id='clip-hex'%3e%3cpath%20d='M64%208%20L104%2032%20L104%2096%20L64%20120%20L24%2096%20L24%2032%20Z'/%3e%3c/clipPath%3e%3c/defs%3e%3c!--%20背景六边形外框%20--%3e%3cpath%20d='M64%208%20L104%2032%20L104%2096%20L64%20120%20L24%2096%20L24%2032%20Z'%20fill='none'%20stroke='url(%23g-neon)'%20stroke-width='4'%20filter='url(%23f-glow)'/%3e%3c!--%20赛博网格%20--%3e%3cg%20clip-path='url(%23clip-hex)'%20opacity='0.25'%3e%3crect%20x='20'%20y='20'%20width='88'%20height='88'%20fill='none'%20stroke='%2300e5ff'%20stroke-width='1'/%3e%3cg%20stroke='%23ff00aa'%20stroke-width='0.8'%3e%3cpath%20d='M24%2040%20H104'/%3e%3cpath%20d='M24%2060%20H104'/%3e%3cpath%20d='M24%2080%20H104'/%3e%3c/g%3e%3cg%20stroke='%238ef511'%20stroke-width='0.8'%3e%3cpath%20d='M40%2032%20V104'/%3e%3cpath%20d='M64%2024%20V112'/%3e%3cpath%20d='M88%2032%20V104'/%3e%3c/g%3e%3c/g%3e%3c!--%20闪电图形%20--%3e%3cpath%20d='M76%2024%20L56%2064%20L72%2064%20L52%20104%20L90%2060%20L72%2060%20Z'%20fill='url(%23g-neon)'%20filter='url(%23f-glow)'%20opacity='0.95'/%3e%3c!--%20赛博字母%20G（代表%20Game）%20--%3e%3cg%20transform='translate(0,2)'%3e%3cpath%20d='M64%2044%20m%20-22%200%20a%2022%2022%200%201%200%2044%200%20a%2022%2022%200%201%200%20-44%200%20M%2066%2044%20L%2078%2044%20L%2078%2056'%20fill='none'%20stroke='url(%23g-neon)'%20stroke-width='5'%20stroke-linecap='round'%20stroke-linejoin='round'%20filter='url(%23f-glow)'/%3e%3c/g%3e%3c!--%20装饰脉冲线%20--%3e%3cg%20opacity='0.8'%3e%3cpath%20d='M16%2018%20H46'%20stroke='%2300e5ff'%20stroke-width='2'/%3e%3cpath%20d='M82%20110%20H112'%20stroke='%23ff00aa'%20stroke-width='2'/%3e%3cpath%20d='M12%2086%20H32'%20stroke='%238ef511'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",Ie="https://zfpnrvxduvtckrnwghia.supabase.co",Ue="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmcG5ydnhkdXZ0Y2tybndnaGlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExMTI2NzcsImV4cCI6MjA3NjY4ODY3N30.av5KTfLRc3bDc16F641NeDfXpBVFuuM6pQK2XTm960Q",N=Ae(Ie,Ue),ie="game_forum_store_v1";function Se(){try{const o=localStorage.getItem(ie);return o?JSON.parse(o):null}catch{return null}}function Le(o){localStorage.setItem(ie,JSON.stringify(o))}function j(o){return o+"_"+Math.random().toString(36).slice(2,10)}function ue(o){return o?Array.isArray(o)?o.filter(Boolean):String(o).split(",").map(s=>s.trim()).filter(Boolean):[]}function ce(o,s){if(!o&&s)return[s].filter(Boolean);if(Array.isArray(o))return o.filter(Boolean);const t=String(o||"").trim();return t?[t]:[]}const Me={user:null,profiles:{},relations:{},searchGame:"",searchForum:"",games:[{id:"game_demo",title:"示例游戏：永夜传说",company:"星环工作室",price:128,genre:"角色扮演",genres:["角色扮演"],background:"在永夜笼罩的大陆，玩家踏上寻找曙光的旅途。",gameplay:"开放世界探索 + 回合制战斗 + 队伍养成。",officialUrl:"https://example.com/demo-game",cover:"",gallery:["https://picsum.photos/seed/game1/1200/600","https://picsum.photos/seed/game2/1200/600","https://picsum.photos/seed/game3/1200/600"],createdAt:Date.now(),ratings:[]}],posts:[{id:"post_demo",title:"新人报道：永夜传说初体验",author:"小明",content:"战斗节奏不错，剧情也挺吸引人。你们都玩到哪了？",createdAt:Date.now(),likes:3,comments:[{id:j("c"),author:"路人甲",content:"刚打完第一章 Boss！",createdAt:Date.now()}]}]};function De(o){const s=JSON.parse(JSON.stringify(Me)),t=o&&typeof o=="object"?o:{};return s.user=t.user??s.user,s.games=Array.isArray(t.games)?t.games:s.games,s.posts=Array.isArray(t.posts)?t.posts:s.posts,s.profiles=t.profiles&&typeof t.profiles=="object"?t.profiles:{},s.relations=t.relations&&typeof t.relations=="object"?t.relations:{},s.games=s.games.map(l=>{var a;return{...l,gallery:ue(l.gallery),genres:ce(l.genres,((a=l.genre)==null?void 0:a.trim())||"未分类")}}),s.posts=s.posts.map(l=>({...l,images:Array.isArray(l.images)?l.images:[]})),s}const Ge=Se(),y=H(De(Ge));ae(y,o=>Le(o),{deep:!0});async function Ve(o){var w,F,M,k,D,I,B,te,se,oe;const s=j("g"),t=((w=o.title)==null?void 0:w.trim())||"未命名游戏",l=((F=o.company)==null?void 0:F.trim())||"未知公司",a=Number(o.price)||0,r=((M=o.genre)==null?void 0:M.trim())||Array.isArray(o.genres)&&o.genres[0]||"未分类",p=ce(o.genres,((k=o.genre)==null?void 0:k.trim())||"未分类"),g=((D=o.background)==null?void 0:D.trim())||"",m=((I=o.gameplay)==null?void 0:I.trim())||"",i=((B=o.officialUrl)==null?void 0:B.trim())||"",_=((te=o.cover)==null?void 0:te.trim())||"",n=ue(o.gallery),v=((se=y.user)==null?void 0:se.name)||"匿名";let d=null;const f={id:s,title:t,company:l,price:a,genre:r,genres:p,background:g,gameplay:m,officialUrl:i,cover:_,gallery:n,createdAt:Date.now(),creator:v,supabase_id:null};y.games.unshift(f);try{const K=(oe=y.user)==null?void 0:oe.id,{data:z,error:ne}=await N.from("games").insert([{title:t,company:l,price:a,genres:p,background:g,gameplay:m,official_url:i,cover_url:_,creator:K,created_at:new Date().toISOString()}]).select();if(ne)return console.error("保存游戏到Supabase失败:",ne),{localId:s,supabaseId:null};console.log("游戏已保存到Supabase:",z),z&&z.length>0&&(d=z[0].id,f.supabase_id=d)}catch(K){console.error("保存游戏过程中出错:",K)}return{localId:s,supabaseId:d}}function de(o){return y.games.find(s=>s.id===o)}function Fe(o,s){const t=de(o);if(!t)return null;const l=Math.min(5,Math.max(1,Number(s)||0)),a=j("r");return Array.isArray(t.ratings)||(t.ratings=[]),t.ratings.push({id:a,stars:l,createdAt:Date.now()}),a}function pe(o){const s=Array.isArray(o==null?void 0:o.ratings)?o.ratings:[];if(s.length===0)return 0;const t=s.reduce((l,a)=>l+(Number(a.stars)||0),0);return Math.round(t/s.length*10)/10}async function Pe(o){var g,m,i,_,n;const s=j("p"),t=((g=o.author)==null?void 0:g.trim())||((m=y.user)==null?void 0:m.name)||"匿名",l=((i=o.title)==null?void 0:i.trim())||"无标题",a=((_=o.content)==null?void 0:_.trim())||"";let r=null;const p={id:s,title:l,author:t,content:a,createdAt:Date.now(),likes:0,images:Array.isArray(o.images)?o.images:[],comments:[],supabase_id:null};y.posts.unshift(p);try{const v=(n=y.user)==null?void 0:n.id,{data:d,error:f}=await N.from("posts").insert([{title:l,author_id:v,author_name:t,content:a,likes:0,created_at:new Date().toISOString()}]).select();if(f)return console.error("保存帖子到Supabase失败:",f),{localId:s,supabaseId:null};console.log("帖子已保存到Supabase:",d),d&&d.length>0&&(r=d[0].id,p.supabase_id=r)}catch(v){console.error("保存帖子过程中出错:",v)}return{localId:s,supabaseId:r}}function Q(o){return y.posts.find(s=>s.id===o)}async function Oe(o){var s;if(o.supabase_id)return o.supabase_id;try{const t=(s=y.user)==null?void 0:s.id,{data:l,error:a}=await N.from("posts").insert([{title:o.title,author_id:t,author_name:o.author,content:o.content,likes:o.likes||0,created_at:new Date(o.createdAt).toISOString()}]).select();if(a)return console.error("为现有帖子创建Supabase记录失败:",a),null;if(l&&l.length>0){const r=l[0].id;return o.supabase_id=r,console.log("已为现有帖子创建Supabase记录:",r),r}}catch(t){console.error("为现有帖子创建Supabase记录过程中出错:",t)}return null}async function Ne(o,s){var g,m,i,_;const t=Q(o);if(!t)return null;const l=j("c"),a=((g=s.author)==null?void 0:g.trim())||((m=y.user)==null?void 0:m.name)||"匿名",r=((i=s.content)==null?void 0:i.trim())||"",p={id:l,author:a,content:r,createdAt:Date.now()};t.comments.push(p);try{const n=(_=y.user)==null?void 0:_.id;let v=t.supabase_id;if(!v&&(v=await Oe(t),!v))return console.warn("无法为帖子创建Supabase记录，跳过数据库保存"),l;if(!n)return console.warn("用户未登录，跳过数据库保存"),l;const{data:d,error:f}=await N.from("comments").insert([{post_id:v,author_id:n,author_name:a,content:r,created_at:new Date().toISOString()}]).select();if(f)return console.error("保存评论到Supabase失败:",f),l;console.log("评论已保存到Supabase:",d)}catch(n){console.error("保存评论过程中出错:",n)}return l}function Te(o){const s=Q(o);return s?(s.likes=(s.likes||0)+1,s.likes):null}async function Be(o,s){try{if(o){const{data:t,error:l}=await N.from("profiles").select("id").eq("name",o).single();if(t&&!l)return!0}if(s){const{data:t,error:l}=await N.from("profiles").select("id").eq("email",s).single();if(t&&!l)return!0}return!1}catch(t){return console.error("检查用户存在性时出错:",t),!1}}async function Re(o){const s=((o==null?void 0:o.username)||"").trim(),t=((o==null?void 0:o.email)||"").trim(),l=((o==null?void 0:o.password)||"").trim();if(!s||s.length<3||!t||!t.includes("@")||!l||l.length<6)return!1;try{if(await Be(s,t))return!1;const{data:r,error:p}=await N.auth.signUp({email:t,password:l,options:{data:{username:s}}});if(p)return console.error("Supabase Auth注册失败:",p),!1;if(!r.user)return!1;const{data:g,error:m}=await N.from("profiles").insert([{id:r.user.id,name:s,avatar_url:null}]).select();return m?(console.error("创建用户档案失败:",m),!1):(y.user={id:r.user.id,name:s,username:s,email:t,createdAt:new Date().toISOString()},y.profiles[s]=y.user,!0)}catch(a){return console.error("注册过程中出错:",a),!1}}async function Ee(o,s={}){const t=((o==null?void 0:o.email)||"").trim(),l=((o==null?void 0:o.password)||"").trim();try{if(!t.includes("@")||!l)return!1;const{data:a,error:r}=await N.auth.signInWithPassword({email:t,password:l});if(r)return console.error("Supabase Auth登录失败:",r),!1;if(!a.user)return!1;const{data:p,error:g}=await N.from("profiles").select("*").eq("id",a.user.id).single();return g?(console.error("获取用户档案失败:",g),!1):(y.user={id:a.user.id,name:p.name,email:a.user.email,username:p.name,avatar_url:p.avatar_url,createdAt:p.created_at},y.profiles[p.name]=y.user,!0)}catch(a){return console.error("登录过程中出错:",a),!1}}function qe(){y.user=null}function Je(o){if(!y.user)return!1;y.user.avatar=o;const s=y.user.name;return y.profiles[s]||(y.profiles[s]={}),y.profiles[s].avatar=o,!0}function ee(o){var s,t;return((t=(s=y.profiles)==null?void 0:s[o])==null?void 0:t.avatar)||null}function q(o){return y.relations[o]||(y.relations[o]={followers:[],following:[]}),y.relations[o]}function Z(o){var t;const s=(t=y.user)==null?void 0:t.name;return!s||!o?!1:q(s).following.includes(o)}function me(o){var a;const s=(a=y.user)==null?void 0:a.name;if(!s||!o||s===o)return!1;const t=q(s),l=q(o);return t.following.includes(o)||t.following.push(o),l.followers.includes(s)||l.followers.push(s),!0}function fe(o){var a;const s=(a=y.user)==null?void 0:a.name;if(!s||!o)return!1;const t=q(s),l=q(o);return t.following=t.following.filter(r=>r!==o),l.followers=l.followers.filter(r=>r!==s),y.relations={...y.relations,[s]:t,[o]:l},!0}function ve(o){return q(o).followers.map(s=>({id:s,name:s,avatar:ee(s)}))}function _e(o){return q(o).following.map(s=>({id:s,name:s,avatar:ee(s)}))}const je={class:"layout"},ze={class:"header"},He={class:"brand"},Ke=["src"],Xe={class:"nav"},Ze={class:"header-tools"},Ye={class:"user-actions"},We={class:"user-name"},Qe={class:"main"},et={__name:"App",setup(o){const s=C(()=>y.user),t=U(localStorage.getItem("theme")||"dark");C(()=>t.value==="dark"?"赛博亮":"赛博暗"),C(()=>t.value==="dark"?"theme-dark":"theme-light");function l(){const a=t.value==="dark"?"theme-dark":"theme-light";document.documentElement.classList.remove("theme-dark","theme-light"),document.documentElement.classList.add(a),localStorage.setItem("theme",t.value)}return l(),Y(l),(a,r)=>{const p=P("router-link"),g=P("router-view");return u(),c("div",je,[e("header",ze,[e("div",He,[e("img",{class:"logo",src:R(xe),alt:"Cyberpunk Logo"},null,8,Ke),r[4]||(r[4]=e("div",{class:"brand-text"},[e("h1",{class:"nggc-title"},"NGGC"),e("span",{class:"brand-sub"},"Next-Gen Game Community")],-1))]),e("nav",Xe,[x(p,{class:"nav-card",to:"/"},{default:A(()=>[...r[5]||(r[5]=[e("span",{class:"nav-title"},"游戏目录",-1),e("span",{class:"nav-sub"},"浏览与跳转详情",-1)])]),_:1}),x(p,{class:"nav-card",to:"/forum"},{default:A(()=>[...r[6]||(r[6]=[e("span",{class:"nav-title"},"论坛",-1),e("span",{class:"nav-sub"},"浏览帖子与交流",-1)])]),_:1}),x(p,{class:"nav-card",to:"/rank"},{default:A(()=>[...r[7]||(r[7]=[e("span",{class:"nav-title"},"排行榜",-1),e("span",{class:"nav-sub"},"按评分/价格排序",-1)])]),_:1})]),e("div",Ze,[a.$route.path==="/"?(u(),c(L,{key:0},[$(e("input",{class:"input search","onUpdate:modelValue":r[0]||(r[0]=m=>R(y).searchGame=m),placeholder:"搜索游戏名称或公司"},null,512),[[S,R(y).searchGame]]),e("button",{class:"search-btn",onClick:r[1]||(r[1]=(...m)=>a.searchAction&&a.searchAction(...m)),"aria-label":"搜索"},[...r[8]||(r[8]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M21 21l-4.3-4.3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("circle",{cx:"11",cy:"11",r:"7",stroke:"currentColor","stroke-width":"2"})],-1)])])],64)):a.$route.path.startsWith("/forum")?(u(),c(L,{key:1},[$(e("input",{class:"input search","onUpdate:modelValue":r[2]||(r[2]=m=>R(y).searchForum=m),placeholder:"搜索作者或标题"},null,512),[[S,R(y).searchForum]]),e("button",{class:"search-btn",onClick:r[3]||(r[3]=(...m)=>a.searchAction&&a.searchAction(...m)),"aria-label":"搜索"},[...r[9]||(r[9]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M21 21l-4.3-4.3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("circle",{cx:"11",cy:"11",r:"7",stroke:"currentColor","stroke-width":"2"})],-1)])])],64)):G("",!0)]),e("div",Ye,[s.value?(u(),c(L,{key:0},[e("span",We,"你好，"+h(s.value.name),1),x(p,{class:"btn small",to:"/profile"},{default:A(()=>[...r[10]||(r[10]=[b("个人中心",-1)])]),_:1})],64)):(u(),X(p,{key:1,class:"nav-card small",to:"/auth"},{default:A(()=>[...r[11]||(r[11]=[e("span",{class:"nav-title"},"登录",-1),e("span",{class:"nav-sub"},"进入个人中心",-1)])]),_:1}))])]),e("main",Qe,[(u(),X(g,{key:a.$route.fullPath}))]),r[12]||(r[12]=e("footer",{class:"footer"},[e("small",null,"© 2025 游戏论坛. 仅用于演示，数据保存在浏览器。")],-1))])}}},O=(o,s)=>{const t=o.__vccOpts||o;for(const[l,a]of s)t[l]=a;return t},tt={class:"carousel"},st=["src"],ot={class:"dots"},nt=["onClick"],lt={__name:"Carousel",props:{images:{type:Array,default:()=>[]},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:4e3}},setup(o){const s=o,t=U(0);let l=null;const a=C(()=>({width:`${s.images.length*100}%`,transform:`translateX(-${t.value*(100/s.images.length)}%)`}));function r(){t.value=(t.value+1)%Math.max(s.images.length,1)}function p(){t.value=(t.value-1+Math.max(s.images.length,1))%Math.max(s.images.length,1)}function g(_){t.value=_%Math.max(s.images.length,1)}function m(){!s.autoplay||s.images.length<=1||(i(),l=setInterval(r,s.interval))}function i(){l&&(clearInterval(l),l=null)}return Y(m),ye(i),ae(()=>s.images,()=>{t.value=0,m()}),(_,n)=>(u(),c("div",tt,[e("div",{class:"track",style:be(a.value)},[(u(!0),c(L,null,V(o.images,(v,d)=>(u(),c("div",{class:"slide",key:d},[e("img",{src:v,alt:""},null,8,st)]))),128))],4),e("button",{class:"ctrl prev",onClick:p,"aria-label":"上一张"},"‹"),e("button",{class:"ctrl next",onClick:r,"aria-label":"下一张"},"›"),e("div",ot,[(u(!0),c(L,null,V(o.images,(v,d)=>(u(),c("button",{key:d,class:T(["dot",{active:d===t.value}]),onClick:f=>g(d),"aria-label":"跳转到第 {{ idx + 1 }} 张"},null,10,nt))),128))])]))}},he=O(lt,[["__scopeId","data-v-76d39d9c"]]),at={class:"panel"},rt={class:"type-wrap"},it=["onClick"],ut={class:"type-name"},ct={class:"type-actions"},dt=["disabled"],pt={class:"toolbar"},mt={class:"grid cols-3"},ft=["onClick","onKeydown"],vt={key:0,class:"cover"},_t=["src","alt"],ht={class:"body"},gt={class:"row"},yt={class:"title"},bt={class:"badge"},kt={class:"company"},wt={class:"price"},$t={key:0,class:"empty"},Ct={__name:"GameList",setup(o){const s=C(()=>{const n=y.games.map(v=>v.cover).filter(Boolean);return n.length?n:["https://picsum.photos/seed/banner1/1200/600","https://picsum.photos/seed/banner2/1200/600","https://picsum.photos/seed/banner3/1200/600"]}),t=["动作游戏","角色扮演游戏","模拟游戏","策略游戏","休闲游戏","益智游戏","射击游戏","体育游戏","竞速游戏","音乐游戏"],l=U([]),a=C(()=>{const n=(y.searchGame||"").trim().toLowerCase(),v=f=>{if(l.value.length===0)return!0;const w=Array.isArray(f.genres)?f.genres:f.genre?[f.genre]:[];return l.value.every(F=>w.includes(F))},d=f=>{var w,F;return n?((w=f.title)==null?void 0:w.toLowerCase().includes(n))||((F=f.company)==null?void 0:F.toLowerCase().includes(n)):!0};return y.games.filter(f=>v(f)&&d(f))});function r(n){const v=l.value.indexOf(n);v>=0?l.value.splice(v,1):l.value.push(n)}function p(){l.value=[]}const g=U(null);function m(n){const v=g.value;if(!v)return;const d=v.clientWidth*.8;v.scrollBy({left:n*d,behavior:"smooth"})}const i=J();function _(n){i.push(`/game/${n}`)}return Y(()=>{}),(n,v)=>{const d=P("router-link");return u(),c("section",at,[x(he,{images:s.value},null,8,["images"]),e("div",rt,[e("button",{class:"type-scroll ctrl prev",onClick:v[0]||(v[0]=f=>m(-1))},"‹"),e("div",{class:"type-grid",ref_key:"typeGridRef",ref:g},[(u(),c(L,null,V(t,f=>e("button",{key:f,class:T(["type-card",{active:l.value.includes(f)}]),onClick:w=>r(f)},[e("span",ut,h(f),1)],10,it)),64))],512),e("div",ct,[e("button",{class:"btn small",onClick:p,disabled:l.value.length===0},"清除筛选",8,dt)]),e("button",{class:"type-scroll ctrl next",onClick:v[1]||(v[1]=f=>m(1))},"›")]),v[3]||(v[3]=e("h2",null,"游戏目录",-1)),v[4]||(v[4]=e("p",{class:"muted"},"点击卡片进入详情页，查看游戏背景、玩法、公司、定价及官网链接。",-1)),e("div",pt,[x(d,{class:"btn secondary",to:"/add"},{default:A(()=>[...v[2]||(v[2]=[b("添加游戏",-1)])]),_:1})]),e("div",mt,[(u(!0),c(L,null,V(a.value,f=>(u(),c("article",{key:f.id,class:"card clickable",onClick:w=>_(f.id),onKeydown:ke(w=>_(f.id),["enter"]),tabindex:"0",role:"button"},[f.cover?(u(),c("div",vt,[e("img",{src:f.cover,alt:f.title},null,8,_t)])):G("",!0),e("div",ht,[e("div",gt,[e("h3",yt,h(f.title),1),e("span",bt,h(f.genres&&f.genres[0]||f.genre),1)]),e("p",kt,"开发/发行："+h(f.company),1),e("p",wt,"定价：¥"+h(f.price),1)])],40,ft))),128))]),R(y).games.length===0?(u(),c("div",$t,"暂无游戏，快去添加吧！")):G("",!0)])}}},At=O(Ct,[["__scopeId","data-v-5d900a04"]]),xt={class:"panel glass"},It={class:"form-wrap"},Ut={class:"field"},St={class:"genre-grid"},Lt=["value"],Mt={class:"actions"},Dt={__name:"GameForm",setup(o){const s=J(),t=["动作游戏","角色扮演游戏","模拟游戏","策略游戏","休闲游戏","益智游戏","射击游戏","体育游戏","竞速游戏","音乐游戏"],l=H({title:"",company:"",genre:"",genres:[],price:"",background:"",gameplay:"",officialUrl:"",cover:"",gallery:[]});async function a(m){return new Promise((i,_)=>{const n=new FileReader;n.onload=()=>i(n.result),n.onerror=_,n.readAsDataURL(m)})}async function r(m){var _;const i=(_=m.target.files)==null?void 0:_[0];i&&(l.cover=await a(i))}async function p(m){const i=Array.from(m.target.files||[]),_=[];for(const n of i)_.push(await a(n));l.gallery=_}async function g(){try{const m=await Ve(l);s.push(`/game/${m.localId}`)}catch(m){console.error("添加游戏失败:",m)}}return(m,i)=>{const _=P("router-link");return u(),c("section",xt,[i[18]||(i[18]=e("h2",null,"添加游戏",-1)),i[19]||(i[19]=e("p",{class:"muted"},"由客户填写游戏介绍与官网链接，提交后将出现在目录中，详情页可查看全部信息。",-1)),e("div",It,[e("form",{class:"grid",onSubmit:E(g,["prevent"])},[e("label",null,[i[7]||(i[7]=b(" 游戏名称 ",-1)),$(e("input",{"onUpdate:modelValue":i[0]||(i[0]=n=>l.title=n),class:"input",placeholder:"如：永夜传说",required:""},null,512),[[S,l.title]])]),e("label",null,[i[8]||(i[8]=b(" 公司/工作室 ",-1)),$(e("input",{"onUpdate:modelValue":i[1]||(i[1]=n=>l.company=n),class:"input",placeholder:"如：星环工作室"},null,512),[[S,l.company]])]),e("div",Ut,[i[9]||(i[9]=e("div",{class:"label"},"游戏类型（可多选）",-1)),e("div",St,[(u(),c(L,null,V(t,n=>e("label",{key:n,class:"check"},[$(e("input",{type:"checkbox",value:n,"onUpdate:modelValue":i[2]||(i[2]=v=>l.genres=v)},null,8,Lt),[[W,l.genres]]),e("span",null,h(n),1)])),64))])]),e("label",null,[i[10]||(i[10]=b(" 定价（人民币） ",-1)),$(e("input",{"onUpdate:modelValue":i[3]||(i[3]=n=>l.price=n),type:"number",min:"0",class:"input",placeholder:"如：128"},null,512),[[S,l.price,void 0,{number:!0}]])]),e("label",null,[i[11]||(i[11]=b(" 游戏背景 ",-1)),$(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=n=>l.background=n),class:"textarea",rows:"4",placeholder:"世界观、故事背景等"},null,512),[[S,l.background]])]),e("label",null,[i[12]||(i[12]=b(" 玩法介绍 ",-1)),$(e("textarea",{"onUpdate:modelValue":i[5]||(i[5]=n=>l.gameplay=n),class:"textarea",rows:"4",placeholder:"核心玩法、模式、特色等"},null,512),[[S,l.gameplay]])]),e("label",null,[i[13]||(i[13]=b(" 官网链接 ",-1)),$(e("input",{"onUpdate:modelValue":i[6]||(i[6]=n=>l.officialUrl=n),class:"input",placeholder:"https://..."},null,512),[[S,l.officialUrl]])]),e("label",null,[i[14]||(i[14]=b(" 封面图片（本地上传） ",-1)),e("input",{type:"file",accept:"image/*",class:"input",onChange:r},null,32)]),e("label",null,[i[15]||(i[15]=b(" 图片画廊（可选择多张） ",-1)),e("input",{type:"file",multiple:"",accept:"image/*",class:"input",onChange:p},null,32)]),e("div",Mt,[i[17]||(i[17]=e("button",{class:"btn",type:"submit"},"提交",-1)),x(_,{class:"btn secondary",to:"/"},{default:A(()=>[...i[16]||(i[16]=[b("返回目录",-1)])]),_:1})])],32)])])}}},Gt=O(Dt,[["__scopeId","data-v-801601af"]]),Vt={key:0,class:"panel"},Ft={class:"header-row"},Pt={key:0,class:"badges"},Ot={key:1,class:"badge"},Nt={class:"grid cols-2"},Tt={class:"muted"},Bt=["href"],Rt={key:1,class:"muted"},Et={key:0,class:"cover"},qt=["src","alt"],Jt={class:"text"},jt={class:"text"},zt={class:"rating"},Ht={class:"stars"},Kt=["onMouseenter","onClick"],Xt={class:"meta"},Zt={class:"actions"},Yt={key:1,class:"panel"},Wt={__name:"GameDetail",setup(o){const s=re(),t=C(()=>de(s.params.id)),l=C(()=>{var _,n;const i=((_=t.value)==null?void 0:_.gallery)||[];return i.length?i:(n=t.value)!=null&&n.cover?[t.value.cover]:["https://picsum.photos/seed/gdetail1/1200/600"]}),a=U(0),r=C(()=>a.value),p=C(()=>pe(t.value)),g=C(()=>{var i;return Array.isArray((i=t.value)==null?void 0:i.ratings)?t.value.ratings.length:0});function m(i){t.value&&Fe(t.value.id,i)}return(i,_)=>{var v;const n=P("router-link");return t.value?(u(),c("section",Vt,[e("div",Ft,[e("h2",null,h(t.value.title),1),(v=t.value.genres)!=null&&v.length?(u(),c("span",Pt,[(u(!0),c(L,null,V(t.value.genres,d=>(u(),c("span",{class:"badge",key:d},h(d),1))),128))])):(u(),c("span",Ot,h(t.value.genre),1))]),e("div",Nt,[e("div",null,[e("p",Tt,"公司/工作室："+h(t.value.company||"未知"),1),e("p",null,[_[1]||(_[1]=b("定价：",-1)),e("strong",null,"¥"+h(t.value.price),1)]),e("p",null,[_[2]||(_[2]=b(" 官网： ",-1)),t.value.officialUrl?(u(),c("a",{key:0,href:t.value.officialUrl,target:"_blank",rel:"noopener noreferrer"},h(t.value.officialUrl),9,Bt)):(u(),c("span",Rt,"未提供"))]),t.value.cover?(u(),c("div",Et,[e("img",{src:t.value.cover,alt:t.value.title},null,8,qt)])):G("",!0)]),e("div",null,[_[3]||(_[3]=e("h3",null,"游戏背景",-1)),e("p",Jt,h(t.value.background||"暂无背景介绍。"),1),_[4]||(_[4]=e("h3",null,"玩法介绍",-1)),e("p",jt,h(t.value.gameplay||"暂无玩法介绍。"),1),_[5]||(_[5]=e("h3",null,"图片画廊",-1)),x(he,{images:l.value},null,8,["images"]),_[6]||(_[6]=e("h3",null,"评分",-1)),e("div",zt,[e("div",Ht,[(u(),c(L,null,V(5,d=>e("button",{key:d,class:T(["star-btn",{active:d<=r.value}]),onMouseenter:f=>a.value=d,onMouseleave:_[0]||(_[0]=f=>a.value=0),onClick:f=>m(d),"aria-label":"评分 {{ n }} 星"},"★",42,Kt)),64))]),e("div",Xt,"平均："+h(p.value)+" 星 · 共 "+h(g.value)+" 次评分",1)])])]),e("div",Zt,[x(n,{class:"btn secondary",to:"/"},{default:A(()=>[..._[7]||(_[7]=[b("返回目录",-1)])]),_:1}),x(n,{class:"btn",to:"/forum"},{default:A(()=>[..._[8]||(_[8]=[b("去论坛交流",-1)])]),_:1})])])):(u(),c("section",Yt,[_[10]||(_[10]=e("h2",null,"未找到该游戏",-1)),x(n,{class:"btn",to:"/"},{default:A(()=>[..._[9]||(_[9]=[b("返回目录",-1)])]),_:1})]))}}},Qt=O(Wt,[["__scopeId","data-v-7dbb6d4a"]]),es={class:"panel"},ts={class:"header-row"},ss={class:"feed"},os=["onClick"],ns={class:"author-row"},ls=["src"],as={key:1,class:"avatar-fallback"},rs={class:"a-meta"},is={class:"a-name"},us={class:"a-time"},cs=["onClick"],ds={class:"p-title"},ps={key:0,class:"p-images"},ms=["src"],fs={class:"p-actions"},vs=["onClick"],_s={key:0,class:"empty"},hs={__name:"Forum",setup(o){const s=J(),t=U(new Set),l=C(()=>{const n=(y.searchForum||"").trim().toLowerCase();return n?y.posts.filter(v=>{var d,f;return((d=v.author)==null?void 0:d.toLowerCase().includes(n))||((f=v.title)==null?void 0:f.toLowerCase().includes(n))}):y.posts});function a(n){return new Date(n).toLocaleString()}function r(n){s.push(`/forum/post/${n}`)}function p(n){const v=t.value;v.has(n)?v.delete(n):v.add(n)}function g(n){return t.value.has(n)}function m(n){return ee(n)}function i(n){return Z(n)}function _(n){Z(n)?fe(n):me(n)}return(n,v)=>{const d=P("router-link");return u(),c("section",es,[e("div",ts,[v[1]||(v[1]=e("h2",null,"论坛",-1)),x(d,{class:"btn",to:"/forum/new"},{default:A(()=>[...v[0]||(v[0]=[b("发帖",-1)])]),_:1})]),v[2]||(v[2]=e("p",{class:"muted"},"每个人都可以发帖与评论，支持配图与关注作者。",-1)),e("div",ss,[(u(!0),c(L,null,V(l.value,f=>{var w,F;return u(),c("article",{key:f.id,class:"card",onClick:M=>r(f.id)},[e("header",ns,[m(f.author)?(u(),c("img",{key:0,src:m(f.author),class:"avatar"},null,8,ls)):(u(),c("div",as,h(((F=(w=f.author)==null?void 0:w[0])==null?void 0:F.toUpperCase())||"U"),1)),e("div",rs,[e("div",is,h(f.author),1),e("div",us,h(a(f.createdAt)),1)]),e("button",{class:"btn follow",onClick:E(M=>_(f.author),["stop"])},h(i(f.author)?"已关注":"关注"),9,cs)]),e("div",ds,h(f.title),1),e("p",{class:T(["p-text",{expanded:g(f.id)}])},h(f.content),3),Array.isArray(f.images)&&f.images.length?(u(),c("div",ps,[(u(!0),c(L,null,V(f.images,(M,k)=>(u(),c("img",{key:k,src:M},null,8,ms))),128))])):G("",!0),e("div",fs,[e("button",{class:"btn small",onClick:E(M=>p(f.id),["stop"])},h(g(f.id)?"收起":"展开更多"),9,vs)])],8,os)}),128))]),R(y).posts.length===0?(u(),c("div",_s,"暂无帖子，快来发表第一条吧！")):G("",!0)])}}},gs=O(hs,[["__scopeId","data-v-82960cfd"]]),ys={class:"panel glass"},bs={class:"form-wrap"},ks={key:0,class:"img-preview"},ws=["src"],$s={class:"actions"},Cs={__name:"PostForm",setup(o){const s=J(),t=H({title:"",author:"",content:"",images:[]});async function l(){try{const r=await Pe(t);s.push(`/forum/post/${r.localId}`)}catch(r){console.error("发布帖子失败:",r)}}function a(r){const p=Array.from(r.target.files||[]);if(!p.length)return;const g=p.map(m=>new Promise(i=>{const _=new FileReader;_.onload=()=>i(_.result),_.readAsDataURL(m)}));Promise.all(g).then(m=>{t.images=m.slice(0,9)})}return(r,p)=>{const g=P("router-link");return u(),c("section",ys,[p[9]||(p[9]=e("h2",null,"发布新帖",-1)),e("div",bs,[e("form",{class:"grid",onSubmit:E(l,["prevent"])},[e("label",null,[p[3]||(p[3]=b(" 标题 ",-1)),$(e("input",{"onUpdate:modelValue":p[0]||(p[0]=m=>t.title=m),class:"input",placeholder:"请输入标题",required:""},null,512),[[S,t.title]])]),e("label",null,[p[4]||(p[4]=b(" 作者 ",-1)),$(e("input",{"onUpdate:modelValue":p[1]||(p[1]=m=>t.author=m),class:"input",placeholder:"你的名字（可匿名）"},null,512),[[S,t.author]])]),e("label",null,[p[5]||(p[5]=b(" 内容 ",-1)),$(e("textarea",{"onUpdate:modelValue":p[2]||(p[2]=m=>t.content=m),class:"textarea",rows:"6",placeholder:"请输入帖子内容",required:""},null,512),[[S,t.content]])]),e("label",null,[p[6]||(p[6]=b(" 配图（可选，支持多张） ",-1)),e("input",{type:"file",accept:"image/*",multiple:"",onChange:a},null,32)]),t.images.length?(u(),c("div",ks,[(u(!0),c(L,null,V(t.images,(m,i)=>(u(),c("img",{key:i,src:m,alt:""},null,8,ws))),128))])):G("",!0),e("div",$s,[p[8]||(p[8]=e("button",{class:"btn",type:"submit"},"发布",-1)),x(g,{class:"btn secondary",to:"/forum"},{default:A(()=>[...p[7]||(p[7]=[b("返回论坛",-1)])]),_:1})])],32)])])}}},As=O(Cs,[["__scopeId","data-v-79eae509"]]),xs={key:0,class:"panel"},Is={class:"header-row"},Us={class:"meta"},Ss={class:"content"},Ls={class:"like-row"},Ms={key:0,class:"comments"},Ds={class:"row"},Gs={class:"meta"},Vs={class:"text"},Fs={key:1,class:"empty"},Ps={class:"actions"},Os={key:1,class:"panel"},Ns={__name:"PostDetail",setup(o){const s=re(),t=C(()=>Q(s.params.id)),l=H({author:"",content:""});function a(g){return new Date(g).toLocaleString()}async function r(){if(t.value){if(!l.content.trim()){alert("请输入评论内容");return}try{await Ne(t.value.id,l),l.author="",l.content=""}catch(g){console.error("发表评论失败:",g),alert("发表评论失败，请稍后重试")}}}function p(){t.value&&Te(t.value.id)}return(g,m)=>{const i=P("router-link");return t.value?(u(),c("section",xs,[e("div",Is,[e("h2",null,h(t.value.title),1),e("span",Us,"作者："+h(t.value.author)+" · "+h(a(t.value.createdAt)),1)]),e("article",Ss,h(t.value.content),1),e("div",Ls,[e("button",{class:"btn",onClick:p},"👍 点赞 "+h(t.value.likes||0),1)]),e("h3",null,"评论（"+h(t.value.comments.length)+"）",1),t.value.comments.length?(u(),c("div",Ms,[(u(!0),c(L,null,V(t.value.comments,_=>(u(),c("div",{class:"comment",key:_.id},[e("div",Ds,[e("strong",null,h(_.author),1),e("span",Gs,h(a(_.createdAt)),1)]),e("p",Vs,h(_.content),1)]))),128))])):(u(),c("div",Fs,"暂无评论，来说点什么吧！")),e("form",{class:"grid comment-form",onSubmit:E(r,["prevent"])},[e("label",null,[m[2]||(m[2]=b(" 昵称 ",-1)),$(e("input",{"onUpdate:modelValue":m[0]||(m[0]=_=>l.author=_),class:"input",placeholder:"你的名字（可匿名）"},null,512),[[S,l.author]])]),e("label",null,[m[3]||(m[3]=b(" 评论内容 ",-1)),$(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=_=>l.content=_),class:"textarea",rows:"3",placeholder:"请输入评论内容",required:""},null,512),[[S,l.content]])]),e("div",Ps,[m[5]||(m[5]=e("button",{class:"btn",type:"submit"},"发表评论",-1)),x(i,{class:"btn secondary",to:"/forum"},{default:A(()=>[...m[4]||(m[4]=[b("返回论坛",-1)])]),_:1})])],32)])):(u(),c("section",Os,[m[7]||(m[7]=e("h2",null,"未找到该帖子",-1)),x(i,{class:"btn",to:"/forum"},{default:A(()=>[...m[6]||(m[6]=[b("返回论坛",-1)])]),_:1})]))}}},Ts=O(Ns,[["__scopeId","data-v-5e8b0efd"]]),Bs={class:"panel"},Rs={class:"header-row"},Es={class:"controls"},qs={key:0},Js={class:"filters"},js={class:"filter-group"},zs=["value"],Hs=["disabled"],Ks={class:"filter-group"},Xs=["disabled"],Zs={class:"list"},Ys={class:"rank-num"},Ws={class:"body"},Qs={class:"row"},eo={class:"title"},to={class:"badge"},so={class:"company"},oo={key:0},no={key:1},lo={class:"actions"},ao={__name:"Rank",setup(o){const s=U("stars"),t=U("desc"),l=["动作游戏","角色扮演游戏","模拟游戏","策略游戏","休闲游戏","益智游戏","射击游戏","体育游戏","竞速游戏","音乐游戏"],a=U([]),r=U(),p=U();function g(){a.value=[]}function m(){r.value=void 0,p.value=void 0}const i=C(()=>{let _=y.games.map(n=>({...n,avg:pe(n),count:Array.isArray(n.ratings)?n.ratings.length:0}));if(a.value.length&&(_=_.filter(n=>{const v=Array.isArray(n.genres)?n.genres:n.genre?[n.genre]:[];return a.value.some(d=>v.includes(d))})),_=_.filter(n=>{const v=Number(n.price)||0,d=r.value===void 0||r.value===""||v>=Number(r.value),f=p.value===void 0||p.value===""||v<=Number(p.value);return d&&f}),s.value==="stars")return _.sort((n,v)=>v.avg-n.avg||v.count-n.count);{const n=t.value==="asc"?1:-1;return _.sort((v,d)=>n*(v.price-d.price))}});return(_,n)=>{const v=P("router-link");return u(),c("section",Bs,[e("div",Rs,[n[9]||(n[9]=e("h2",null,"排行榜",-1)),e("div",Es,[e("label",null,[n[6]||(n[6]=b(" 排序依据 ",-1)),$(e("select",{class:"select","onUpdate:modelValue":n[0]||(n[0]=d=>s.value=d)},[...n[5]||(n[5]=[e("option",{value:"stars"},"平均星级",-1),e("option",{value:"price"},"价格",-1)])],512),[[le,s.value]])]),s.value==="price"?(u(),c("label",qs,[n[8]||(n[8]=b(" 顺序 ",-1)),$(e("select",{class:"select","onUpdate:modelValue":n[1]||(n[1]=d=>t.value=d)},[...n[7]||(n[7]=[e("option",{value:"asc"},"从低到高",-1),e("option",{value:"desc"},"从高到低",-1)])],512),[[le,t.value]])])):G("",!0)])]),e("div",Js,[e("div",js,[n[10]||(n[10]=e("span",{class:"filter-label"},"按类型筛选（可多选）：",-1)),(u(),c(L,null,V(l,d=>e("label",{key:d,class:"chip"},[$(e("input",{type:"checkbox",value:d,"onUpdate:modelValue":n[2]||(n[2]=f=>a.value=f)},null,8,zs),[[W,a.value]]),e("span",null,h(d),1)])),64)),e("button",{class:"btn small",onClick:g,disabled:a.value.length===0},"清除类型",8,Hs)]),e("div",Ks,[n[11]||(n[11]=e("span",{class:"filter-label"},"价格区间：",-1)),$(e("input",{class:"input small",type:"number",min:"0","onUpdate:modelValue":n[3]||(n[3]=d=>r.value=d),placeholder:"最低价"},null,512),[[S,r.value,void 0,{number:!0}]]),$(e("input",{class:"input small",type:"number",min:"0","onUpdate:modelValue":n[4]||(n[4]=d=>p.value=d),placeholder:"最高价"},null,512),[[S,p.value,void 0,{number:!0}]]),e("button",{class:"btn small",onClick:m,disabled:r.value===void 0&&p.value===void 0},"清除价格",8,Xs)])]),e("div",Zs,[(u(!0),c(L,null,V(i.value,(d,f)=>(u(),c("article",{key:d.id,class:"card row-card"},[e("div",Ys,"#"+h(f+1),1),e("div",Ws,[e("div",Qs,[e("h3",eo,h(d.title),1),e("span",to,h(d.genres&&d.genres[0]||d.genre),1)]),e("p",so,"开发/发行："+h(d.company),1),s.value==="stars"?(u(),c("p",oo,"平均星级："+h(d.avg)+"（"+h(d.count)+"次评分）",1)):(u(),c("p",no,"价格：¥"+h(d.price),1)),e("div",lo,[x(v,{class:"btn",to:`/game/${d.id}`},{default:A(()=>[...n[12]||(n[12]=[b("查看详情",-1)])]),_:1},8,["to"])])])]))),128))])])}}},ro=O(ao,[["__scopeId","data-v-a086fca2"]]),io={class:"login-wrap"},uo={class:"login-card"},co={class:"left"},po={class:"mode-toggle"},mo={key:0},fo={key:1},vo={key:2},_o=["placeholder"],ho={key:3},go={key:4,class:"remember"},yo={class:"actions"},bo={class:"btn",type:"submit"},ko={class:"help"},wo={__name:"Auth",setup(o){const s=J(),t=U(!1),l=U(""),a=U(""),r=U(!0),p=U(""),g=U(""),m=U(""),i=U(""),_=U("");function n(){t.value=!1,d(),f()}function v(){t.value=!0,d(),f()}function d(){l.value="",username.value="",a.value="",p.value="",g.value="",m.value=""}function f(){i.value="",_.value=""}function w(M,k="error"){i.value=M,_.value=k,setTimeout(()=>{f()},3e3)}async function F(){if(t.value){if(!p.value.trim()){w("请输入用户名");return}if(p.value.trim().length<3){w("用户名至少需要3个字符");return}if(!g.value.trim()||!g.value.includes("@")){w("请输入有效的邮箱地址");return}if(!a.value.trim()||a.value.length<6){w("密码至少需要6位");return}if(a.value!==m.value){w("两次输入的密码不一致");return}try{await Re({username:p.value.trim(),email:g.value.trim(),password:a.value})?(w("注册成功！正在跳转到个人中心...","success"),setTimeout(()=>s.push("/profile"),1e3)):w("注册失败，用户名或邮箱可能已被使用")}catch(M){console.error("注册错误:",M),w("注册过程中出现错误，请稍后重试")}}else{if(!l.value.trim()||!l.value.includes("@")){w("请输入有效的邮箱地址");return}if(!a.value.trim()){w("请输入密码");return}try{await Ee({email:l.value,password:a.value},{remember:r.value})?s.push("/profile"):w("登录失败，请检查邮箱和密码")}catch(M){console.error("登录错误:",M),w("登录过程中出现错误，请稍后重试")}}}return(M,k)=>{const D=P("router-link");return u(),c("section",io,[e("div",uo,[e("div",co,[e("h2",null,h(t.value?"注册":"登录"),1),e("div",po,[e("button",{class:T(["mode-btn",!t.value&&"active"]),onClick:n},"登录",2),e("button",{class:T(["mode-btn",t.value&&"active"]),onClick:v},"注册",2)]),e("form",{class:"grid",onSubmit:E(F,["prevent"])},[t.value?(u(),c("label",mo,[k[7]||(k[7]=b(" 用户名 ",-1)),$(e("input",{"onUpdate:modelValue":k[0]||(k[0]=I=>p.value=I),class:"input",placeholder:"设置您的用户名",required:""},null,512),[[S,p.value]])])):G("",!0),t.value?(u(),c("label",fo,[k[8]||(k[8]=b(" 邮箱 ",-1)),$(e("input",{"onUpdate:modelValue":k[1]||(k[1]=I=>g.value=I),class:"input",type:"email",placeholder:"you@example.com",required:""},null,512),[[S,g.value]])])):G("",!0),t.value?G("",!0):(u(),c("label",vo,[k[9]||(k[9]=b(" 邮箱 ",-1)),$(e("input",{"onUpdate:modelValue":k[2]||(k[2]=I=>l.value=I),class:"input",type:"email",placeholder:"you@example.com",required:""},null,512),[[S,l.value]])])),e("label",null,[k[10]||(k[10]=b(" 密码 ",-1)),$(e("input",{"onUpdate:modelValue":k[3]||(k[3]=I=>a.value=I),class:"input",type:"password",placeholder:t.value?"设置密码（至少6位）":"请输入密码",required:""},null,8,_o),[[S,a.value]])]),t.value?(u(),c("label",ho,[k[11]||(k[11]=b(" 确认密码 ",-1)),$(e("input",{"onUpdate:modelValue":k[4]||(k[4]=I=>m.value=I),class:"input",type:"password",placeholder:"再次输入密码",required:""},null,512),[[S,m.value]])])):G("",!0),t.value?G("",!0):(u(),c("label",go,[$(e("input",{type:"checkbox","onUpdate:modelValue":k[5]||(k[5]=I=>r.value=I)},null,512),[[W,r.value]]),k[12]||(k[12]=b(" 记住我 ",-1))])),e("div",yo,[e("button",bo,h(t.value?"注册":"登录"),1),x(D,{class:"btn secondary",to:"/"},{default:A(()=>[...k[13]||(k[13]=[b("返回首页",-1)])]),_:1})])],32),i.value?(u(),c("div",{key:0,class:T(["message",_.value])},h(i.value),3)):G("",!0),e("small",ko,[b(h(t.value?"已有账号？":"还没有账号？")+" ",1),e("a",{href:"#",onClick:k[6]||(k[6]=E(I=>t.value=!t.value,["prevent"]))},h(t.value?"立即登录":"立即注册"),1)])])])])}}},$o=O(wo,[["__scopeId","data-v-8ef9c251"]]),Co={class:"panel"},Ao={class:"header-row"},xo={class:"actions"},Io={key:0,class:"profile"},Uo={class:"hero"},So={class:"hero-row"},Lo={class:"avatar-wrap",title:"点击更换头像"},Mo=["src"],Do={key:1,class:"avatar-fallback"},Go={class:"hero-meta"},Vo={class:"name"},Fo={class:"counts"},Po={class:"tabs"},Oo={class:"me"},No={class:"avatar-wrap",title:"点击更换头像"},To=["src"],Bo={key:1,class:"avatar-fallback"},Ro={class:"meta"},Eo={class:"name"},qo={class:"counts"},Jo={class:"content-wrap"},jo={key:0,class:"feed"},zo={class:"post-head"},Ho={class:"avatar-wrap mini"},Ko=["src"],Xo={key:1,class:"avatar-fallback"},Zo={class:"meta"},Yo={class:"name"},Wo={class:"sub"},Qo={class:"post-body"},en={class:"post-title"},tn={class:"post-content"},sn={class:"post-actions"},on={class:"badge"},nn={key:0,class:"empty"},ln={key:1,class:"feed"},an={class:"post-head"},rn={class:"avatar-wrap mini"},un=["src"],cn={key:1,class:"avatar-fallback"},dn={class:"meta"},pn={class:"name"},mn={class:"sub"},fn={class:"post-body"},vn={class:"post-title"},_n={class:"post-content muted"},hn={class:"post-actions"},gn={key:0,class:"empty"},yn={key:1,class:"empty"},bn={__name:"Profile",setup(o){const s=J(),t=C(()=>y.user),l=C(()=>{var v;return ve((v=t.value)==null?void 0:v.name)}),a=C(()=>{var v;return _e((v=t.value)==null?void 0:v.name)}),r=C(()=>l.value.length),p=C(()=>a.value.length),g=C(()=>(y.games||[]).filter(v=>{var d;return v.creator===((d=t.value)==null?void 0:d.name)})),m=C(()=>(y.posts||[]).filter(v=>{var d;return v.author===((d=t.value)==null?void 0:d.name)})),i=U("posts");function _(){qe(),s.push("/")}function n(v){var w;const d=(w=v.target.files)==null?void 0:w[0];if(!d)return;const f=new FileReader;f.onload=()=>Je(f.result),f.readAsDataURL(d)}return(v,d)=>{var w,F,M,k;const f=P("router-link");return u(),c("section",Co,[e("div",Ao,[d[3]||(d[3]=e("h2",null,"个人中心",-1)),e("div",xo,[t.value?(u(),c("button",{key:0,class:"btn secondary",onClick:_},"退出登录")):(u(),X(f,{key:1,class:"btn",to:"/auth"},{default:A(()=>[...d[2]||(d[2]=[b("去登录",-1)])]),_:1}))])]),t.value?(u(),c("div",Io,[e("div",Uo,[d[4]||(d[4]=e("div",{class:"banner"},null,-1)),e("div",So,[e("label",Lo,[t.value.avatar?(u(),c("img",{key:0,src:t.value.avatar,alt:"avatar"},null,8,Mo)):(u(),c("div",Do,h(((F=(w=t.value.name)==null?void 0:w[0])==null?void 0:F.toUpperCase())||"U"),1)),e("input",{type:"file",accept:"image/*",onChange:n,hidden:""},null,32)]),e("div",Go,[e("div",Vo,h(t.value.name),1),e("div",Fo,[x(f,{class:"count-link",to:"/profile/followers"},{default:A(()=>[b("粉丝 "+h(r.value),1)]),_:1}),x(f,{class:"count-link",to:"/profile/following"},{default:A(()=>[b("关注 "+h(p.value),1)]),_:1})])])])]),e("div",Po,[e("button",{class:T(["tab",i.value==="posts"&&"active"]),onClick:d[0]||(d[0]=D=>i.value="posts")},"我发布的帖子",2),e("button",{class:T(["tab",i.value==="games"&&"active"]),onClick:d[1]||(d[1]=D=>i.value="games")},"我发布的游戏",2)]),e("div",Oo,[e("label",No,[t.value.avatar?(u(),c("img",{key:0,src:t.value.avatar,alt:"avatar"},null,8,To)):(u(),c("div",Bo,h(((k=(M=t.value.name)==null?void 0:M[0])==null?void 0:k.toUpperCase())||"U"),1)),e("input",{type:"file",accept:"image/*",onChange:n,hidden:""},null,32)]),e("div",Ro,[e("div",Eo,h(t.value.name),1),e("div",qo,[e("span",null,"关注 "+h(p.value),1),e("span",null,"粉丝 "+h(r.value),1)])])]),e("div",Jo,[i.value==="posts"?(u(),c("div",jo,[(u(!0),c(L,null,V(m.value,D=>{var I,B;return u(),c("article",{key:D.id,class:"post"},[e("div",zo,[e("label",Ho,[t.value.avatar?(u(),c("img",{key:0,src:t.value.avatar,alt:"avatar"},null,8,Ko)):(u(),c("div",Xo,h(((B=(I=t.value.name)==null?void 0:I[0])==null?void 0:B.toUpperCase())||"U"),1))]),e("div",Zo,[e("div",Yo,h(t.value.name),1),e("div",Wo,h(new Date(D.createdAt).toLocaleDateString()),1)])]),e("div",Qo,[e("h3",en,h(D.title),1),e("p",tn,h(D.content),1)]),e("div",sn,[e("span",on,"赞 "+h(D.likes||0),1),x(f,{class:"btn small",to:`/forum/post/${D.id}`},{default:A(()=>[...d[5]||(d[5]=[b("查看详情",-1)])]),_:1},8,["to"])])])}),128)),m.value.length===0?(u(),c("div",nn,"暂无发布的帖子")):G("",!0)])):(u(),c("div",ln,[(u(!0),c(L,null,V(g.value,D=>{var I,B;return u(),c("article",{key:D.id,class:"post"},[e("div",an,[e("label",rn,[t.value.avatar?(u(),c("img",{key:0,src:t.value.avatar,alt:"avatar"},null,8,un)):(u(),c("div",cn,h(((B=(I=t.value.name)==null?void 0:I[0])==null?void 0:B.toUpperCase())||"U"),1))]),e("div",dn,[e("div",pn,h(t.value.name),1),e("div",mn,h(new Date(D.createdAt).toLocaleDateString()),1)])]),e("div",fn,[e("h3",vn,h(D.title),1),e("p",_n,h(D.company),1)]),e("div",hn,[x(f,{class:"btn small",to:`/game/${D.id}`},{default:A(()=>[...d[6]||(d[6]=[b("查看详情",-1)])]),_:1},8,["to"])])])}),128)),g.value.length===0?(u(),c("div",gn,"暂无发布的游戏")):G("",!0)]))])])):(u(),c("div",yn,"未登录，请先登录。"))])}}},kn=O(bn,[["__scopeId","data-v-e46f45e8"]]),wn={class:"panel"},$n={class:"list-wrap"},Cn={class:"overlay-header"},An=["src"],xn={key:1,class:"mini-fallback"},In={class:"uname"},Un=["onClick"],Sn={key:0,class:"empty"},Ln={__name:"Following",setup(o){const s=C(()=>{var l;return _e((l=y.user)==null?void 0:l.name)});function t(l){fe(l)}return(l,a)=>{const r=P("router-link");return u(),c("section",wn,[e("div",$n,[e("div",Cn,[a[1]||(a[1]=e("h2",{class:"title"},"我的关注",-1)),x(r,{class:"back-link",to:"/profile"},{default:A(()=>[...a[0]||(a[0]=[b("返回个人中心",-1)])]),_:1})]),e("ul",null,[(u(!0),c(L,null,V(s.value,p=>{var g,m;return u(),c("li",{key:p.id,class:"row"},[p.avatar?(u(),c("img",{key:0,src:p.avatar,class:"mini"},null,8,An)):(u(),c("span",xn,h((m=(g=p.name)==null?void 0:g[0])==null?void 0:m.toUpperCase()),1)),e("span",In,h(p.name),1),e("button",{class:"btn small",onClick:i=>t(p.name)},"取消关注",8,Un)])}),128))]),s.value.length===0?(u(),c("div",Sn,"暂无关注")):G("",!0)])])}}},Mn=O(Ln,[["__scopeId","data-v-11df9887"]]),Dn={class:"panel"},Gn={class:"list-wrap"},Vn={class:"overlay-header"},Fn=["src"],Pn={key:1,class:"mini-fallback"},On={class:"uname"},Nn=["onClick"],Tn={key:0,class:"empty"},Bn={__name:"Followers",setup(o){const s=C(()=>{var a;return ve((a=y.user)==null?void 0:a.name)});function t(a){me(a)}function l(a){return Z(a)}return(a,r)=>{const p=P("router-link");return u(),c("section",Dn,[e("div",Gn,[e("div",Vn,[r[1]||(r[1]=e("h2",{class:"title"},"我的粉丝",-1)),x(p,{class:"back-link",to:"/profile"},{default:A(()=>[...r[0]||(r[0]=[b("返回个人中心",-1)])]),_:1})]),e("ul",null,[(u(!0),c(L,null,V(s.value,g=>{var m,i;return u(),c("li",{key:g.id,class:"row"},[g.avatar?(u(),c("img",{key:0,src:g.avatar,class:"mini"},null,8,Fn)):(u(),c("span",Pn,h((i=(m=g.name)==null?void 0:m[0])==null?void 0:i.toUpperCase()),1)),e("span",On,h(g.name),1),l(g.name)?G("",!0):(u(),c("button",{key:2,class:"btn small",onClick:_=>t(g.name)},"关注",8,Nn))])}),128))]),s.value.length===0?(u(),c("div",Tn,"暂无粉丝")):G("",!0)])])}}},Rn=O(Bn,[["__scopeId","data-v-4dee1dcb"]]),En=[{path:"/",name:"home",component:At},{path:"/add",name:"add-game",component:Gt},{path:"/game/:id",name:"game-detail",component:Qt,props:!0},{path:"/forum",name:"forum",component:gs},{path:"/forum/new",name:"post-new",component:As},{path:"/forum/post/:id",name:"post-detail",component:Ts,props:!0},{path:"/rank",name:"rank",component:ro},{path:"/auth",name:"auth",component:$o},{path:"/profile",name:"profile",component:kn},{path:"/profile/following",name:"profile-following",component:Mn},{path:"/profile/followers",name:"profile-followers",component:Rn}],qn=we({history:$e(),routes:En}),ge=Ce(et);ge.use(qn);ge.mount("#app");
